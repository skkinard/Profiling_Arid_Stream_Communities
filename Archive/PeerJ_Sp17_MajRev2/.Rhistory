install.packages("iNEXT")
install.packages("iNEXT")
library(tidyverse)
library(gridExtra)
library(Hmisc)
library("writexl")
library(iNEXT)
fish <- read_csv("sp17_data_files/sp17_site_x_fish.csv")
f_nosite <- select(fish, -site.code, -STAID)
i_fish <- iNEXT(as.data.frame(t(f_nosite))) #create iNEXT object
ggiNEXT(i_fish) #plot rarefaction curves
#Extract Hill numbers from iNEXT object
fish$rich <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Species richness")),4]
fish$rich.s.e <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Species richness")),5]
fish$shannon <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Shannon diversity")),4]
fish$shannon.s.e <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Shannon diversity")),5]
fish$simpson <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Simpson diversity")),4]
fish$simpson.s.e <- i_fish$AsyEst[c(which(i_fish$AsyEst$Diversity == "Simpson diversity")),5]
# export fish divesity metrics
write_xlsx(as.data.frame(fish),"sp17_r_scripts\\fish_div.xlsx")
# Load Packages
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
install.packages("tidyverse")
# Load Packages
library(tidyverse)
library(gridExtra)
library(Hmisc)
install.packages("Hmisc")
getwd()
setwd("C:/Users/s2kin/Dropbox/Research/Manuscipts/Diss.2_Gradient/PeerJ_Sp17_MajRev2")
# Load Packages
library(tidyverse)
library(gridExtra)
library(Hmisc)
library("writexl")
library(iNEXT)
invert <- read_csv("sp17_data_files/sp17_site_x_invert.csv")
f_nosite <- select(invert, -STAID)
i_invert <- iNEXT(as.data.frame(t(f_nosite))) #create iNEXT object
ggiNEXT(i_invert) #plot rarefaction curves
#Extract Hill numbers from iNEXT object
invert$rich <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Species richness")),4]
invert$rich.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Species richness")),5]
invert$shannon <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Shannon diversity")),4]
invert$shannon.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Shannon diversity")),5]
invert$simpson <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Simpson diversity")),4]
invert$simpson.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Simpson diversity")),5]
# Load environmental data
env <- read_csv("sp17_data_files/sp17_site_x_env.csv")
# - # - # - # - # - # - # - # - # - # - # - # - # # - # - # - # - #
# cleaning up data frames to include only the a priori selected variables and community abundance matrix
(env <- select(env, STAID, AP, flash.index, LFPP, NH4., log.cond, Rosgen.Index))
# Merge dataframes to ensure matching rows (sites)
msterinvert <- merge(env,invert, by = "STAID")
# - # - # - # - # - # - # - # - # - # - # - # - # # - # - # - # - #
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Hypothesis test: Diversity Correlates with Precipitation :
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# diversity vs precipitation Linear Regressions
rich_v_AP <- lm(formula= rich ~ AP, data = msterinvert)
summary(rich_v_AP)
#  p-value: 0.5101
shannon_v_AP <- lm(formula= shannon ~ AP, data = msterinvert)
summary(shannon_v_AP)
#  p-value: 0.5061
simpson_v_AP <- lm(formula= simpson ~ AP, data = msterinvert)
summary(simpson_v_AP)
#  p-value: 0.5027
# plots
plot_1 <- ggplot(msterinvert, aes(x=AP, y=rich)) +
geom_smooth(method=lm, se=FALSE, color = "black") +
geom_point(shape=19,aes(size=.1)) +
geom_errorbar(aes(ymin = msterfish$rich-msterfish$rich.s.e, ymax = msterfish$rich + msterfish$rich.s.e)) +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Species Richness") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20)) +
plot_2 <- ggplot(msterinvert, aes(x=AP, y=shannon)) +
geom_point(shape=19,aes(size=.1)) +
geom_errorbar(aes(ymin = msterfish$shannon-msterfish$shannon.s.e, ymax = msterfish$shannon + msterfish$shannon.s.e)) +
geom_smooth(method=loess, se=FALSE, color = "black") +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Shannon Entropy") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20))
plot_3 <- ggplot(msterinvert, aes(x=AP, y=simpson)) +
geom_point(shape=19,aes(size=.1)) +
geom_errorbar(aes(ymin = msterfish$simpson-msterfish$simpson.s.e, ymax = msterfish$simpson + msterfish$simpson.s.e)) +
geom_smooth(method=loess, se=FALSE, color = "black") +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Gini-Simpson Index") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20))
grid.arrange(plot_1, plot_2, plot_3, nrow=1)
invert <- read_csv("sp17_data_files/sp17_site_x_invert.csv")
getwd()
invert <- read_csv("sp17_data_files/sp17_site_x_invert.csv")
invert
f_nosite <- select(invert, -STAID)
i_invert <- iNEXT(as.data.frame(t(f_nosite))) #create iNEXT object
ggiNEXT(i_invert) #plot rarefaction curves
#Extract Hill numbers from iNEXT object
invert$rich <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Species richness")),4]
invert$rich.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Species richness")),5]
invert$shannon <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Shannon diversity")),4]
invert$shannon.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Shannon diversity")),5]
invert$simpson <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Simpson diversity")),4]
invert$simpson.s.e <- i_invert$AsyEst[c(which(i_invert$AsyEst$Diversity == "Simpson diversity")),5]
# Load environmental data
env <- read_csv("sp17_data_files/sp17_site_x_env.csv")
# Load Packages
library(tidyverse)
library(gridExtra)
library(Hmisc)
library("writexl")
# Load Data
invert <- read_csv("sp17_data_files/invert_diversity_estimates.csv")
env <- read_csv("sp17_data_files/sp17_site_x_env.csv")
# - # - # - # - # - # - # - # - # - # - # - # - # # - # - # - # - #
# cleaning up data frames to include only the a priori selected variables and community abundance matrix
(env <- select(env, STAID, AP, flash.index, LFPP, NH4., log.cond, Rosgen.Index))
# Merge dataframes to ensure matching rows (sites)
msterinvert <- merge(env,invert, by = "STAID")
# - # - # - # - # - # - # - # - # - # - # - # - # # - # - # - # - #
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Hypothesis test: Diversity Correlates with Precipitation :
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Species richness
summary(lm(formula= rich ~ AP, data = msterinvert))
# p-value: 0.5101
# Shannon Entropy
summary(lm(formula= shannon ~ AP, data = msterinvert))
# p-value: 0.505
# Simpson Entropy
summary(lm(formula= simpson ~ AP, data = msterinvert))
# p-value: 0.5009
# plots (All Sites)
plot_1 <- ggplot(msterinvert, aes(x=AP, y=rich)) +
geom_smooth(method=lm, formula = y ~ poly(x, 3), se=FALSE, color = "grey", linetype = 'dashed') +
geom_point(shape=19,aes(size=.1)) +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Species Richness") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20))
plot_2 <- ggplot(msterinvert, aes(x=AP, y=shannon)) +
geom_smooth(method=lm, formula = y ~ poly(x, 3), se=FALSE, color = "grey", linetype = 'dashed') +
geom_point(shape=19,aes(size=.1)) +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Shannon Entropy") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20))
plot_3 <- ggplot(msterinvert, aes(x=AP, y=simpson)) +
geom_smooth(method=lm, formula = y ~ poly(x, 3), se=FALSE, color = "grey", linetype = 'dashed') +
geom_point(shape=19,aes(size=.1)) +
scale_x_continuous(name = "Precipitation (cm/yr)") +
scale_y_continuous(name = "Gini-Simpson Index") +
theme_classic() +
theme(legend.position="none") +
theme(text = element_text(size = 20))
grid.arrange(plot_1, plot_2, plot_3, nrow=1)
